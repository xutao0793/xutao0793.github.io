(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{297:function(t,s,a){t.exports=a.p+"assets/img/Redux.91ebd4f9.png"},298:function(t,s,a){t.exports=a.p+"assets/img/redux.91ebd4f9.png"},299:function(t,s,a){t.exports=a.p+"assets/img/Redux_use.1a3c8a1d.png"},713:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"what-is-redux"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#what-is-redux","aria-hidden":"true"}},[t._v("#")]),t._v(" what is Redux")]),t._v(" "),n("p",[n("code",[t._v("Redux")]),t._v(" 是 "),n("code",[t._v("JavaScript")]),t._v(" 的状态容器， 提供可预测化的状态管理。")]),t._v(" "),n("p",[n("strong",[t._v("什么是可预测化？")]),t._v("\n可以理解为根据一个固定的输入，必然会得到一个固定的输出。是一个纯函数的性质。")]),t._v(" "),n("p",[n("strong",[t._v("什么是状态？")]),t._v("\n我们把应用程序的数据称为状态。这是有道理的，因为我们所说的数据会随着时间的推移发生变化，这其实就是应用的状态。")]),t._v(" "),n("p",[t._v("所以"),n("code",[t._v("Redux")]),t._v("就是一个组织应用程序数据的管理器，我们把应用程序的所有数据给它托管，然后只能用它对外提供给我们的一些固定的 API 方法来操作这些数据。")]),t._v(" "),n("h1",{attrs:{id:"why-need-redux"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#why-need-redux","aria-hidden":"true"}},[t._v("#")]),t._v(" why need Redux ?")]),t._v(" "),n("blockquote",[n("p",[t._v("现在前端应用开发的基本架构：MVC")]),t._v(" "),n("ul",[n("li",[t._v("数据和视图的分离解耦（开放封闭原则）；视图层 View：使用框架"),n("code",[t._v("React")]),t._v(" "),n("code",[t._v("Vue")]),t._v("等；数据模型 Model，即数据状态管理使用"),n("code",[t._v("Redux")]),t._v(" "),n("code",[t._v("Vuex")])]),t._v(" "),n("li",[t._v("以数据驱动视图，只关心数据变化，DOM 操作被封装，数据变化驱动视图更新:控制器 Control")])])]),t._v(" "),n("p",[n("strong",[n("code",[t._v("React")]),t._v(" 本身只是非常轻量级的视图层框架，用来构建用户视图。")])]),t._v(" "),n("p",[t._v("用 "),n("code",[t._v("React")]),t._v(" 写项目时，我们通过一个个组件来构建一个应用，但是如果一个应用中组件很多，组件之间经常要共享一些数据，这些数据可能来自服务器端，用户输入的数据，用户交互数据，当前 UI 状态，本地的缓存数据等等。如何能够有条理的管理这些数据？")]),t._v(" "),n("p",[t._v("如果只用 "),n("code",[t._v("React")]),t._v(" 本身提供的数据通信方式（父子通信、context 通信）来写，那将会很复杂，因为任何一个子组件都可以通过 context 修改全局数据，无法追踪数据变化。所以说 "),n("code",[t._v("React")]),t._v(" 只是非常轻量级的视图层框架。如果做大型的应用，就需要在 "),n("code",[t._v("React")]),t._v(" 的基础上配套一个面向数据层的数据管理框架和 "),n("code",[t._v("React")]),t._v(" 结合使用，这样我们就会把应用程序的所有数据全部委托给这个数据管理器，每个组件获取或修改数据就只能通过数据管理器提供方式去操作，这样数据的变化就得可预测和可控了。")]),t._v(" "),n("p",[n("strong",[n("code",[t._v("Redux")]),t._v(" 就是一个数据层的框架")])]),t._v(" "),n("p",[t._v("我们把应用程序的数据（state）和每个数据对应的变更的方式（action)提供给"),n("code",[t._v("Redux")]),t._v(" ，那么 "),n("code",[t._v("Redux")]),t._v(" 就会提供一个仓库 store，把所有的数据都放在该仓库中 store 里，外部组件要从 store 里拿数据必须用"),n("code",[t._v("store.getState()")]),t._v("方法，然后组件修改 store 里的数据必须用"),n("code",[t._v("store.dispatch(action)")]),t._v("方法。\n"),n("img",{attrs:{src:a(297),alt:"Redux"}})]),t._v(" "),n("p",[n("strong",[n("code",[t._v("Redux 和 React-Redux")])]),t._v(" "),n("strong",[n("code",[t._v("Redux= Reducer + Flux")])])]),t._v(" "),n("p",[t._v("要注意的是，"),n("code",[t._v("Redux")]),t._v(" 和 "),n("code",[t._v("React-Redux")]),t._v(" 并不是同一个东西。"),n("code",[t._v("Redux")]),t._v(" 是一种架构模式（"),n("code",[t._v("Flux")]),t._v(" 架构的一种变种），它不关注你到底用什么库，你可以把 "),n("code",[t._v("Redux")]),t._v(" 应用到 "),n("code",[t._v("React")]),t._v(" 和 "),n("code",[t._v("Vue")]),t._v("，甚至跟 "),n("code",[t._v("jQuery")]),t._v(" 结合都没有问题。\n而 "),n("code",[t._v("React-Redux")]),t._v(" 就是把 "),n("code",[t._v("Redux")]),t._v(" 这种架构模式和 "),n("code",[t._v("React.js")]),t._v(" 结合起来的一个库，就是 "),n("code",[t._v("Redux")]),t._v(" 架构在 "),n("code",[t._v("React.js")]),t._v(" 中的体现。")]),t._v(" "),n("p",[n("code",[t._v("React-Redux")]),t._v("主要实现了将 store 挂载到 react 的全局上下文 context，以及为各个子组件 redux 的 API 和数据状态改变关联的组件视图的更新逻辑。")]),t._v(" "),n("p",[n("strong",[n("code",[t._v("Redux")]),t._v("三大原则")])]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("单一数据源")]),t._v("\n使用 redux 的程序，所有的 state 都存储在一个单一的数据源 store 内部，类似一个巨大的对象树。")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("state 是只读的")]),t._v("\nstate 是只读的，能改变 state 的唯一方式是通过触发 action 来修改")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("使用纯函数执行修改")]),t._v("\n为了描述 action 如何改变 state tree ，你需要编写 reducers。")]),t._v(" "),n("blockquote",[n("p",[t._v("一个函数的返回结果只依赖于它的参数，并且在执行过程里面没有副作用，我们就把这个函数叫做纯函数")])])])]),t._v(" "),n("h1",{attrs:{id:"redux核心概念"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#redux核心概念","aria-hidden":"true"}},[t._v("#")]),t._v(" "),n("code",[t._v("Redux")]),t._v("核心概念")]),t._v(" "),n("p",[n("img",{attrs:{src:a(298),alt:"Redux"}})]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("store")]),t._v("\nstore 是存储数据的公共区域，应用程序的所有数据都放在了 store 中。一个 "),n("code",[t._v("Redux")]),t._v(" 应用只有一个单一的 store。\n"),n("strong",[t._v("创建 store")]),t._v("\n创建一个 store，需要传入 reduer，用来描述 store 内部如何通过 action 改变 state。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" createStore "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'redux'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" counter "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./reducers'")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" store "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createStore")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("counter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\n    store 提供了以下功能：\n    - 维持应用的 ")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("state"),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("；\n    - 提供 ")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getState")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v(" 方法获取 state；\n    - 提供 ")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("action"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v(" 方法更新 state；\n    - 通过 ")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("subscribe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("listener"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v(" 注册监听器;\n    - 通过 ")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("subscribe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("listener"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("` 返回的值函数注销监听器\n")])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("state")]),t._v("\n单词的意思是状态，但什么是状态，前面已经说了，可以理解为状态就是数据在某一时刻的快照。")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("getState")]),t._v("\n用于获取某一时间数据的方法。这是唯一能够获取 state 的方法。")])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("action")]),t._v("\naction 描述了一个更新 state 的动作。任何导致数据 state 变化的行为都是一个 action\n它是一个对象，其中 type 属性是必须有的，除了 type 字段外，action 对象的其它属性完全由你自己决定。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'UPDATE_TITLE_COLOR'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" titleColor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'green'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("ul",[n("li",[n("strong",[t._v("action types")]),t._v("\n在一般项目中，各类数据特别多，所有对应执行数据变更的动作 action 种类也特别多，这个时候可以使用一个单独文件来定义和组织项目中的所有 action type 类型，并使用常量来定义，这是最佳实践。")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// actionTypes.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INCREASE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'INCREASE'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DECREASE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DECREASE'")]),t._v("\n")])])]),n("ul",[n("li",[n("strong",[t._v("actionCreator")]),t._v("\n如上图，调用 rducer dispatch 都是需要传入 action，特别是 dispatch 使用频率跟 action 数量相当，所以每次参数都书写一个 action 对象会显得特别麻烦，而 actionCreator 就是定义一个 action 对象的一个方法。它是一个函数，传入 action 的负载参数，返回一个 action 对象。")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// actions.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INCREASE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DECREASE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../actionTypes'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 函数声明形式")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("increase")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INCREASE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" count "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ES6 箭头函数形式")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("decrease")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("count")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DECREASE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" count "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("reducer")]),t._v("\nreducers 描述了 action 如何改变 state\nreducer 是更新 state 的核心，它里面封装了更新 state 的逻辑，reducer 是一个纯函数，由外界提供（封装业务逻辑，在 createStore 时传入），并传入旧 state 对象和 action，返回新的 state\n"),n("code",[t._v("js reducer = (previousState, action) => newState")]),t._v("\n谨记 reducer 一定要保持纯净。只要传入参数相同，返回计算得到的下一个 state 就一定相同。没有特殊情况、没有副作用、没有 API 请求、没有变量修改，单纯执行计算。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// reducers.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INCREASE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DECREASE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../actionTypes'")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" initState "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tcount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("countReducer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" initState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" action")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("switch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("action"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INCREASE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t\tcount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" action"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" state\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("ul",[n("li",[n("p",[n("strong",[t._v("combineReducers")]),t._v("\n在应用中，把应用的整个 reducer 写在一文件中，会导致 switch 的分支 case 非常冗长，难以查看。这时需要将 reducer 拆分多个，每个 reducer 负责维护部分 state，最后通过"),n("code",[t._v("Redux")]),t._v("提供的 "),n("code",[t._v("combineReducers")]),t._v("函数来合成一个最终的"),n("code",[t._v("reducer")]),t._v("用于创建 store。类似 webpack 中 webpack-mergey 库的作用。")]),t._v(" "),n("pre",[n("code",[t._v("```js\nimport { combineReducers } from 'redux'\n\nconst counter = combineReducers({\ncountReducer,\nlogReducer\n})\n\nexport default counter\n```\n")])])])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("dispatch")])]),t._v(" "),n("p",[t._v("它用于派发一个动作 action，这是唯一的一个能够修改 state 的方法。\n它内部的做的一件事情是将派发的动作 action 作为参数传入 store 初始时获取的 reducer，reducer 会根据传入的 action 执行对应的逻辑，基于旧的 state 来更新出一个新的 state。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用 action 对象形式")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INCREASE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DECREASE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../actionTypes'")]),t._v("\nstore"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INCREASE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用actionCreator形式")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("increase"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" decrease"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./actions'")]),t._v("\n    store"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("increase")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("`\n\n")])])])])]),t._v(" "),n("h1",{attrs:{id:"how-to-use-redux"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#how-to-use-redux","aria-hidden":"true"}},[t._v("#")]),t._v(" how to use Redux ?")]),t._v(" "),n("p",[n("img",{attrs:{src:a(299),alt:"Redux use"}})]),t._v(" "),n("ol",[n("li",[n("strong",[t._v("定义动作类型 action types")])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// actionTypes.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INCREAMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'INCREAMENT'")]),t._v("\n")])])]),n("ol",{attrs:{start:"2"}},[n("li",[n("strong",[t._v("通过 actionCreator 创建 action:")])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// actions.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INCREAMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./actionTypes'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("increase")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("count")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INCREASE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" count "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("ol",{attrs:{start:"3"}},[n("li",[n("strong",[t._v("定义 reducer")])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// reducers.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INCREAMENT")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./actionTypes'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" initState "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("reducer")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("initState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" action")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("switch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("action"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INCREAMENT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" action"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("ol",{attrs:{start:"4"}},[n("li",[n("strong",[t._v("创建 store")])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" reducer "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./reducers'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" createStore "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'redux'")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" store "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createStore")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reducer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("ol",{attrs:{start:"5"}},[n("li",[n("strong",[t._v("订阅状态 state 变化")])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("loggerCount")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" unsubscribleLoggerCount "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" store"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("subcribe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("loggerCount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("ol",{attrs:{start:"6"}},[n("li",[n("strong",[t._v("dispatch 派发一个增加计数的动作")])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" increase "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./actions'")]),t._v("\nstore"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("increase")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("h1",{attrs:{id:"参考资料"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考资料","aria-hidden":"true"}},[t._v("#")]),t._v(" 参考资料")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://mp.weixin.qq.com/s/SEtYfMofnGNoxYpXWx1wDg",target:"_blank",rel:"noopener noreferrer"}},[t._v("从零开始手写 redux"),n("OutboundLink")],1),t._v(" "),n("a",{attrs:{href:"https://mp.weixin.qq.com/s/jfDrhX6jMr36dRaFCH9Xbw",target:"_blank",rel:"noopener noreferrer"}},[t._v("完全理解 redux（从零实现一个 redux）"),n("OutboundLink")],1),t._v(" "),n("a",{attrs:{href:"https://github.com/react-guide/redux-tutorial-cn",target:"_blank",rel:"noopener noreferrer"}},[t._v("redux 简明教程"),n("OutboundLink")],1),t._v(" "),n("a",{attrs:{href:"http://huziketang.mangojuice.top/books/react/lesson30",target:"_blank",rel:"noopener noreferrer"}},[t._v("React.js 小书"),n("OutboundLink")],1),t._v(" "),n("a",{attrs:{href:"https://www.jianshu.com/p/786e7174b0c2",target:"_blank",rel:"noopener noreferrer"}},[t._v("一个小项目让你学会使用 redux"),n("OutboundLink")],1),t._v(" "),n("a",{attrs:{href:"https://www.jianshu.com/p/f6c5434c6e2d",target:"_blank",rel:"noopener noreferrer"}},[t._v("Redux 使用流程与个人心得（一）"),n("OutboundLink")],1),t._v(" "),n("a",{attrs:{href:"https://www.jianshu.com/p/ad7eddb23d66",target:"_blank",rel:"noopener noreferrer"}},[t._v("React-Redux"),n("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);