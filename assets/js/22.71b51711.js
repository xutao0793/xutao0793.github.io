(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{592:function(e,n,t){"use strict";var a=t(99);t.n(a).a},596:function(e,n,t){"use strict";t.r(n);t(50),t(399),t(400);var a=t(401),s=t.n(a),r={name:"CompareVue2WithVue3",directives:{hljs:{inserted:function(e){e.querySelectorAll("pre code").forEach((function(e){s.a.highlightBlock(e)}))}}}},o=(t(592),t(0)),i=Object(o.a)(r,(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[e._m(0),e._v(" "),t("main",[t("div",{staticClass:"content"},[t("section",[e._m(1),e._v(" "),t("div",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(2)])]),e._v(" "),t("section",[e._m(3),e._v(" "),t("p",[e._v("vue3 新增 setup 方法，有两个重点：")]),e._v(" "),t("p",[e._v("1. 组件主要 script 逻辑都在 setup 函数体内完成，包括声明响应式数据data，计算属性 couputed，方法 methods，副作用观察 watch / watchEffect，生命周期等。")]),e._v(" "),t("p",[e._v("2. setup 方法有两个形参 props / context")]),e._v(" "),t("div",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(4)])]),e._v(" "),t("section",[e._m(5),e._v(" "),e._m(6),e._v(" "),t("div",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(7),e._v(" "),e._m(8),e._v(" "),e._m(9)])]),e._v(" "),t("section",[e._m(10),e._v(" "),t("div",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(11),e._v(" "),e._m(12)])]),e._v(" "),t("section",[e._m(13),e._v(" "),t("div",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(14)])]),e._v(" "),t("section",[e._m(15),e._v(" "),t("div",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(16)])]),e._v(" "),t("section",[e._m(17),e._v(" "),t("p",[e._v("watch 需要显示指明侦听对象，watchEffect 会自动处理侦听函数中所依赖的需要侦听的对象，所以入参只有一个侦听函数")]),e._v(" "),t("div",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(18)])]),e._v(" "),t("section",[e._m(19),e._v(" "),t("p",[e._v("props 声明不变，使用变化。")]),e._v(" "),t("div",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(20)])]),e._v(" "),t("section",[e._m(21),e._v(" "),t("p",[e._v("注册子组件方式不变")]),e._v(" "),t("div",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(22)])]),e._v(" "),t("section",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(23),e._v(" "),e._m(24)]),e._v(" "),t("section",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(25)]),e._v(" "),t("section",[e._m(26),e._v(" "),t("p",[e._v("在 Vue3 中，取消了 filter 实现，建议使用计算属性 computed 代替")]),e._v(" "),t("div",{directives:[{name:"hljs",rawName:"v-hljs"}]},[t("pre",{staticClass:"language-js language-xml"},[e._v("  "),t("code",[e._v("\nexport default {\n  name: 'example',\n  data() {\n    return {\n      count: 1\n    }\n  }\n  filters: {\n    dollar(val) {\n      return '$' + val\n    }\n  },\n  template: `<div>"+e._s(e._f("dollar")(e.count))+"</div>`\n}")]),e._v("\n  "),t("code",[e._v("import { computed } from 'vue'\nexport default {\n  name: 'example',\n  setup() {\n    const count = ref(1)\n    const dollar = computed(() => {\n      return '$' + count.value\n    })\n    return {\n      count,\n      dollar\n    }\n  }  \n}")]),e._v("\n            ")])])]),e._v(" "),t("section",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(27),e._v(" "),t("p",[e._v("vue 2.x 的 mixins 被废弃， vue3 的函数式编程天然具有独立功能抽离共用的能力")]),e._v(" "),e._m(28)]),e._v(" "),t("section",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(29),e._v(" "),t("p",[e._v("beforeCreate 和 created 被废弃，使用 setup ，调用时机在两者之间，所以 setup 方法内部无法使用 this")]),e._v(" "),e._m(30)]),e._v(" "),t("section",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(31),e._v(" "),t("p",[e._v("在 Vue 2.x 中，全局API使用全局Vue对象来提供配置，在Vue3 中使用 createApp() 创建的实例对象来配置")]),e._v(" "),e._m(32)]),e._v(" "),t("section",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(33),e._v(" "),t("p",[e._v("在 Vue 2.x 中，这些实例属性都挂载在组件当前 this 对象上。在 Vue 3 中， setup方法第二个参数提供了部分属性：attrs / slots / emit")]),e._v(" "),e._m(34)]),e._v(" "),t("section",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(35),e._v(" "),t("p",[e._v("除此之外，像 $root / $parent / $child 等实例属性，可以直接使用 getCurrentInstance 方法获取，相当于原来的 this")]),e._v(" "),e._m(36)]),e._v(" "),t("section",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(37),e._v(" "),t("p",[e._v("template 模板中 ref 属性的绑定在使用方式上，跟在模板中使用响应式数据的方法上实现了统一")]),e._v(" "),e._m(38)]),e._v(" "),t("section",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(39),e._v(" "),t("p",[e._v("vue 2.x 中全局属性 Vue.nextTick() 或者实例属性 vm.$nectTick()，在 Vue3 中变成一个可引入的全局API nextTick()，返回一个promise")]),e._v(" "),e._m(40)]),e._v(" "),t("section",{directives:[{name:"hljs",rawName:"v-hljs"}]},[e._m(41),e._v(" "),t("p",[e._v("Vue 2.x 通过 Vue.extend() 创建一个新组件，并用 Vue.component() 注册组件；或者直接使用 Vue.component() 创建并注册组件")]),e._v(" "),t("p",[e._v("Vue3 定义了 defineComponent 方法来创建一个组件")]),e._v(" "),t("pre",{staticClass:"language-js language-xml"},[e._v("            "),t("code",[e._v("// Vue.extend() 返回一个构造器函数\nconst MyComponent = Vue.extend({\n  template: '<p>"+e._s(e.firstName)+" "+e._s(e.lastName)+" aka "+e._s(e.alias)+"</p>',\n  data: function () {\n    return {\n      firstName: 'Walter',\n      lastName: 'White',\n      alias: 'Heisenberg'\n    }\n  }\n})\n\n// Vue.component() 注册组件，传入一个扩展过的构造器\nVue.component('my-component', Vue.extend({ /* ... */ }))\nVue.component('my-component', MyComponent)\n\n// 注册组件，传入一个选项对象 (自动调用 Vue.extend)\nVue.component('my-component', { /* ... */ })\n\n// 获取注册的组件 (始终返回构造器)\nvar MyComponent = Vue.component('my-component')\n            ")]),e._v("\n            "),t("code",[e._v("import { defineComponent } from 'vue'\nconst MyComponent = defineComponent({\n  name: 'MyComponent',\n  setup() {\n    const count = ref(0)\n    return (\n      <div>{count.value}</div>\n    )\n  }\n})\n            ")]),e._v("\n          ")])]),e._v(" "),e._m(42)])])])}),[function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("aside",[t("nav",{attrs:{id:"nav"}},[t("p",[e._v("初始化应用")]),e._v(" "),t("a",{attrs:{href:"#initialization"}},[e._v("initialization")]),e._v(" "),t("p",[e._v("常规 Options ")]),e._v(" "),t("a",{attrs:{href:"#setup"}},[e._v("setup 新增")]),e._v(" "),t("a",{attrs:{href:"#data"}},[e._v("data")]),e._v(" "),t("a",{attrs:{href:"#computed"}},[e._v("computed")]),e._v(" "),t("a",{attrs:{href:"#methods"}},[e._v("methods")]),e._v(" "),t("a",{attrs:{href:"#watch"}},[e._v("watch")]),e._v(" "),t("a",{attrs:{href:"#watchEffect"}},[e._v("watchEffect 新增")]),e._v(" "),t("a",{attrs:{href:"#props"}},[e._v("props")]),e._v(" "),t("a",{attrs:{href:"#components"}},[e._v("components")]),e._v(" "),t("a",{attrs:{href:"#provide-inject"}},[e._v("provide / inject")]),e._v(" "),t("a",{attrs:{href:"#directive"}},[e._v("directive")]),e._v(" "),t("a",{attrs:{href:"#filters"}},[e._v("filters 废弃")]),e._v(" "),t("a",{attrs:{href:"#mixins"}},[e._v("mixins 废弃")]),e._v(" "),t("p",[e._v("生命周期 liftcycle")]),e._v(" "),t("a",{attrs:{href:"#liftcycle"}},[e._v("beforeCreate")]),e._v(" "),t("a",{attrs:{href:"#setup"}},[e._v("setup")]),e._v(" "),t("a",{attrs:{href:"#liftcycle"}},[e._v("created")]),e._v(" "),t("a",{attrs:{href:"#liftcycle"}},[e._v("beforeMount => onBeforeMount")]),e._v(" "),t("a",{attrs:{href:"#liftcycle"}},[e._v("mounted => onMounted")]),e._v(" "),t("a",{attrs:{href:"#liftcycle"}},[e._v("beforeUpdate => onBeforeUpdate ")]),e._v(" "),t("a",{attrs:{href:"#liftcycle"}},[e._v("updated => onUpdated")]),e._v(" "),t("a",{attrs:{href:"#liftcycle"}},[e._v("beforeDestroy => onBeforeUnmount")]),e._v(" "),t("a",{attrs:{href:"#liftcycle"}},[e._v("destoryed => onUnmounted")]),e._v(" "),t("a",{attrs:{href:"#liftcycle"}},[e._v("errorCaptured => onErrorCaptured")]),e._v(" "),t("p",[e._v("实例属性")]),e._v(" "),t("a",{attrs:{href:"#context"}},[e._v("$attrs")]),e._v(" "),t("a",{attrs:{href:"#context"}},[e._v("$slots")]),e._v(" "),t("a",{attrs:{href:"#context"}},[e._v("$emit")]),e._v(" "),t("a",{attrs:{href:"#refs"}},[e._v("$refs")]),e._v(" "),t("a",{attrs:{href:"#nextTick"}},[e._v("$nextTick")]),e._v(" "),t("a",{attrs:{href:"#getCurrentInstance"}},[e._v("$root")]),e._v(" "),t("a",{attrs:{href:"#getCurrentInstance"}},[e._v("$parent")]),e._v(" "),t("a",{attrs:{href:"#getCurrentInstance"}},[e._v("$listeners")]),e._v(" "),t("p",[e._v("全局属性")]),e._v(" "),t("a",{attrs:{href:"#defineComponent"}},[e._v("Vue.extend")]),e._v(" "),t("a",{attrs:{href:"#globalApi"}},[e._v("Vue.component")]),e._v(" "),t("a",{attrs:{href:"#directive"}},[e._v("Vue.directive")]),e._v(" "),t("a",{attrs:{href:"#globalApi"}},[e._v("Vue.mixin")]),e._v(" "),t("a",{attrs:{href:"#globalApi"}},[e._v("Vue.use")]),e._v(" "),t("a",{attrs:{href:"#nextTick"}},[e._v("Vue.nextTick")]),e._v(" "),t("a",{attrs:{href:"#"}},[e._v("Vue.compile")]),e._v(" "),t("a",{attrs:{href:"#"}},[e._v("Vue.version")]),e._v(" "),t("p",[e._v("弃用")]),e._v(" "),t("a",{attrs:{href:"#filters"}},[e._v("Vue.filter")]),e._v(" "),t("a",{attrs:{href:"#abandon"}},[e._v("Vue.observable")]),e._v(" "),t("a",{attrs:{href:"#abandon"}},[e._v("Vue.set")]),e._v(" "),t("a",{attrs:{href:"#abandon"}},[e._v("Vue.delete")]),e._v(" "),t("a",{attrs:{href:"#abandon"}},[e._v("$set")]),e._v(" "),t("a",{attrs:{href:"#abandon"}},[e._v("$delete")]),e._v(" "),t("a",{attrs:{href:"#abandon"}},[e._v("$on")]),e._v(" "),t("a",{attrs:{href:"#abandon"}},[e._v("$once")]),e._v(" "),t("a",{attrs:{href:"#abandon"}},[e._v("$off")])])])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"initialization"}},[n("a",{attrs:{href:"#initialization"}},[this._v("#")]),this._v("initialization")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",[this._v("              "),n("code",[this._v("import Vue from 'vue';\nimport App from './App';\n\nconst app = new Vue({\n  render: h => h(App)\n})\napp.$mount('#app')\n              ")]),this._v("\n              "),n("code",[this._v("import { createApp } from 'vue';\nimport App from './App';\n\nconst app = createApp(App)\napp.mount('#app')\n              ")]),this._v("\n            ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"setup"}},[n("a",{attrs:{href:"#setup"}},[this._v("#")]),this._v("setup")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[this._v("              "),n("code",[this._v("export default {\n  setup(props, ctx) {\n    console.log(props, ctx); // 上下文对象ctx：attrs / slots / emit\n  }\n}")]),this._v("\n            ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"data"}},[n("a",{attrs:{href:"#data"}},[this._v("#")]),this._v("\n            data\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("p",[this._v("在 Vue2.x 中，只要在 data 中的数据，框架内部自动会将其处理成响应式数据。但在 Vue3 中，采用函数式编程，需要手动将需要的数据设置成响应式数据，暴露的 API 包括："),n("b",[this._v("ref / reactive")]),this._v("，以及两个工具函数用于将 reactive 后的对象属性设置为中化单独的响应式："),n("b",[this._v("toRef / toRefs")]),this._v("。")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[this._v("  "),n("code",[this._v("\nexport default {\n  name: 'example',\n  data() {\n    return {\n      count: 0\n    }\n  }\n}")]),this._v("\n  "),n("code",[this._v("import { ref } from 'vue'\nexport default {\n  name: 'example',\n  setup() {\n    const count = ref(0)\n    return {\n      count\n    }\n  }  \n}")]),this._v("\n            ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[this._v("  "),n("code",[this._v("\nexport default {\n  name: 'example',\n  data() {\n    return {\n      pagination: {\n        pageSize: 10,\n        pageNo: 1,\n        total: 100\n      }\n    }\n  }\n}")]),this._v("\n  "),n("code",[this._v("import { reactive } from 'vue'\nexport default {\n  name: 'example',\n  setup() {\n    const pagination = reactive({\n      pageSize: 10,\n      pageNo: 1,\n      total: 100\n    })\n    return {\n      pagination\n    }\n  }  \n}")]),this._v("\n            ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[this._v("  "),n("code",[this._v("import { toRef } from 'vue'\nexport default {\n  name: 'example',\n  setup() {\n    const pagination = reactive({\n      pageSize: 10,\n      pageNo: 1,\n      total: 100\n    })\n    const pageNo = toRef(pagination, 'pageNo')\n    return {\n      pageNo\n    }\n  }  \n}")]),this._v("\n    "),n("code",[this._v("import { toRefs } from 'vue'\nexport default {\n  name: 'example',\n  setup() {\n    const pagination = reactive({\n      pageSize: 10,\n      pageNo: 1,\n      total: 100\n    })\n    const { pageSize, pageNo, total } = toRefs(pagination)\n    return {\n      pageSize,\n      pageNo,\n      total\n    }\n  }  \n}")]),this._v("\n            ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"computed"}},[n("a",{attrs:{href:"#computed"}},[this._v("#")]),this._v("\n            computed\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[this._v("  "),n("code",[this._v("\nexport default {\n  name: 'example',\n  data() {\n    return {\n      count: 1\n    }\n  },\n  computed: {\n    double() {\n      return this.count * 2\n    }\n  }\n}")]),this._v("\n  "),n("code",[this._v("import { ref, computed } from 'vue'\nexport default {\n  name: 'example',\n  setup() {\n    const count = ref(1)\n    const double = computed(() => {\n      return count.value * 2\n    })\n    return {\n      count,\n      double\n    }\n  }  \n}")]),this._v("\n    ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[n("code",[this._v("\nexport default {\n  name: 'example',\n  props: {\n    show: {\n      type: Boolean,\n      default: false\n    }\n  }\n  computed: {\n    showModal: {\n      get() {\n        return this.show\n      },\n      set(value) {\n        this.$emit('update:show', value)\n      }\n    }\n  }\n}")]),this._v("\n"),n("code",[this._v("import { computed } from 'vue'\nexport default {\n  name: 'example',\n  props: {\n    show: {\n      type: Boolean,\n      default: false\n    }\n  }\n  setup(props, ctx) {\n    const showModal = computed({\n      get() {\n        return props.show\n      },\n      set(value) {\n        ctx.emit('update:show', value)\n      }\n    })\n    return {\n      showModal\n    }\n  }  \n}")]),this._v("\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"method"}},[n("a",{attrs:{href:"#method"}},[this._v("#")]),this._v("\n            method\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[this._v("  "),n("code",[this._v("\nexport default {\n  name: 'example',\n  data() {\n    return {\n      count: 1\n    }\n  }\n  methods: {\n    increase() {\n      this.count++\n    }\n  }\n}")]),this._v("\n  "),n("code",[this._v("import { ref } from 'vue'\nexport default {\n  name: 'example',\n  setup() {\n    const count = ref(1)\n    function increase() {\n      count.value++\n    }\n    return {\n      count,\n      increase\n    }\n  }  \n}")]),this._v("\n            ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"watch"}},[n("a",{attrs:{href:"#watch"}},[this._v("#")]),this._v("\n            watch\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[this._v("  "),n("code",[this._v("\nexport default {\n  name: 'example',\n  data() {\n    return {\n      a: 1,\n      b: 2,\n      d: {\n        e: {\n          f: 4\n        }\n      }\n    }\n  }\n  // watch 属性调用\n  watch: {\n    // 侦听一个值\n    a: function(newValue, oldValue) {\n      console.log('new: %s, old: %s', newValue, oldValue);\n    },\n    // 侦听属性配置\n    b: {\n      immediate: true,\n      handler: function(newValue, oldValue) {\n        console.log('new: %s, old: %s', newValue, oldValue);\n      }\n    },\n    // 侦听对象某个属性，并实现多个侦听回调\n    'd.e': {\n      deep: true,\n      immediate: true,\n      handler: [handler1, handler2,...]\n    }\n  },\n  created() {\n    // this.$watch 代码调用\n    const unWatch = this.$watch('d.e', (newValue, oldValue) => {\n      console.log('new: %s, old: %s', newValue, oldValue);\n    }, {\n      deep: true,\n      immediate: true\n    })\n    // do something 后取消侦听，\n    unWatch()\n  }\n}")]),this._v("\n  "),n("code",[this._v("import { ref, reactive, watch } from 'vue'\nexport default {\n  name: 'example',\n  setup() {\n    const a = ref(1)\n    const b = reactive({c: 2})\n    \n    // 直接侦听一个ref\n    watch(a, (newValue, oldValue) => {\n      console.log('new: %s, old: %s', newValue, oldValue);\n    })\n    \n    // 侦听一个 getter\n    watch(() => b.c, (newValue, oldValue) => {\n      console.log('new: %s, old: %s', newValue, oldValue);\n    })\n\n    // 侦听属性配置 deep immediate\n    watch(\n      a,\n      (newValue, oldValue) => {\n        console.log('new: %s, old: %s', newValue, oldValue);\n      },\n      {\n        deep: true,\n        immediate: true\n      }\n    )\n\n    // 同时侦听多个\n    watch([a, () => b.c], ([newValue_a, oldValue_a], [newValue_b_c, oldValue_b_c]) => {\n      console.log('watch a new: %s, old: %s', newValue_a, oldValue_a);\n      console.log('watch b.c new: %s, old: %s', newValue_b_c, oldValue_b_c);\n    })\n\n    // 取消侦听\n    cosnt unWatch = watch(a, (newValue, oldValue) => {\n      console.log('new: %s, old: %s', newValue, oldValue);\n    })\n    unWatch()\n    \n    // TODO: 清除副作用\n\n    // TODO： 副作用刷新时机\n    return {\n      a,\n      b\n    }\n  }  \n}")]),this._v("\n            ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"watchEffect"}},[n("a",{attrs:{href:"#watchEffect"}},[this._v("#")]),this._v("\n            watchEffect 新增\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[this._v("            "),n("code",[this._v("import { watchEffect, ref } from 'vue'\nexport default {\n  name: 'example',\n  setup() {\n    const count = ref(0)\n    // 常规使用\n    watchEffect(() => {\n      console.log(count.value)\n    })\n\n    // 主动卸载侦听器\n    const unWatch = watchEffect(() => {\n      console.log(count.value)\n    })\n    \n    function someMethod() {\n      unWatch()\n    }\n    \n    // 清除副作用，回调函数入参 onInvalidate\n    watchEffect((onInvalidate) => {\n      const token = performAsyncOperation(id.value)\n      onInvalidate(() => {\n        // id 改变时 或 停止侦听时\n        // 取消之前的异步操作\n        token.cancel()\n      })\n    })\n    return {\n      count,\n      someMethod\n    }\n  }      \n}")]),this._v("\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"props"}},[n("a",{attrs:{href:"#props"}},[this._v("#")]),this._v("\n            props\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[this._v("              "),n("code",[this._v("\nexport default {\n  name: 'example',\n  props: {\n    show: {\n      type: Boolean,\n      default: false,\n      required: true\n    }\n  }\n  methods: {\n    onClose() {\n      console.log(this.show)\n    }\n  }\n}")]),this._v("\n              "),n("code",[this._v("import { watchEffect, toRef, toRefs } from 'vue'\nexport default {\nname: 'example',\nprops: {\n  show: {\n    type: Boolean,\n    default: false,\n    required: true\n  }\n}\nsetup(props) { // 不能直接在形参上解构，否则会丢失响应式: setup({show}) {...}\n  const showRaw = props.show // 同样没有响应式联动\n  const showRef = toRef(props, 'show')\n  const { show } = toRefs(props)\n\n  watchEffect(() => {\n    console.log(props.show, showRaw);\n  })\n  return {\n    showRef,\n    show\n  }\n}\n}")]),this._v("\n            ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"components"}},[n("a",{attrs:{href:"#components"}},[this._v("#")]),this._v("\n            components\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[this._v("            "),n("code",[this._v("import Child from './components/Child'\nexport default {\n  name: 'example',\n  components: {\n    Child\n  },\n  data() {\n    return {\n\n    }\n  }\n}")]),this._v("\n"),n("code",[this._v("import Child from './components/Child'\nexport default {\n  name: 'example',\n  components: {\n    Child\n  },\n  setup(props, ctx) {\n    return {\n\n    }\n  }\n}< \n")]),this._v("\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"provide-inject"}},[n("a",{attrs:{href:"#provide-inject"}},[this._v("#")]),this._v("\n            provide / inject\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[this._v("            "),n("code",[this._v("// 父组件 Partent.vue\nexport default {\n  name: 'parent',\n  components: {\n    Child\n  }\n  provide: {\n    bgColor: 'red'\n  }\n}\n// 子组件 Child 中 使用 inject 有三种方式\nexport default {\n  name: 'child',\n  inject: ['bgColor'], // 字符形式\n  inject: { \n    bgColor: {\n      default: 'blue' // 提供默认值\n    }\n  },\n  inject: {\n    themeColor: { // 重命名，声明来自from哪个provide的属性\n      from: 'bgColor',\n      default: 'blue'\n    }\n  }\n}")]),this._v("\n"),n("code",[this._v("// 父组件 Parent.vue\nimport { provide } from 'vue';\nexport default {\n  name: 'parent',\n  components: {\n    Child\n  }\n  setup() {\n    provide('bgColor', 'red') // 此时 bgColor 不具有响应式\n    const bgColor = ref('red')\n    provide('bgColor', bgColor)\n\n    return {\n    }\n  }\n}\n// 子组件 Child\nimport { inject } from 'vue'; \nexport default {\n  name: 'child',\n  setup() {\n    const themeColor = inject('bgColor', 'blue')\n    return {\n    }\n  }\n}")]),this._v("\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"directive"}},[n("a",{attrs:{href:"#directive"}},[this._v("#")]),this._v("\n            directive\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"filter"}},[n("a",{attrs:{href:"#filter"}},[this._v("#")]),this._v("\n            filter 废弃\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"mixins"}},[n("a",{attrs:{href:"#mixins"}},[this._v("#")]),this._v("\n            mixins 废弃\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[this._v("            "),n("code",[this._v("import mousePosition from './mixins/mousePosition.js'\nexport default {\n  name: 'example',\n  mixins: [mousePosition]\n  methods: {\n    onShowPosition() {\n      console.log('x: %s, y: %s', this.x, this.y)\n    }\n  }\n}")]),this._v("\n"),n("code",[this._v("import useMousePositon from './utils/mousePosition'\nexport default {\n  name: 'example',\n  setup() {\n    const { x, y } = useMousePositon()\n\n    function onShowPosition() {\n      console.log('x: %s, y: %s', x, y)\n    }\n    return {}\n  }\n}< \n")]),this._v("\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"liftcycle"}},[n("a",{attrs:{href:"#liftcycle"}},[this._v("#")]),this._v("\n            liftcycle 组件生命周期\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[this._v("            "),n("code",[this._v("\n\n\n\n\n\n\n\nexport default {\n  name: 'example',\n  beforeCreate() {...},\n  create() {...},\n  beforeMount() {...},\n  mounted() {...},\n  beforeUpdate() {...},\n  updated() {...}\n  beforeDestroy() {...}\n  destoryed() {...}\n}")]),this._v("\n            "),n("code",[this._v("import {\n  onBeforeMount,\n  onMounted,\n  onBeforeUpdate,\n  onUpdated,\n  onBeforeUnmount,\n  onUnmounted\n} from 'vue'\nexport default {\n  name: 'example',\n  setup(props, ctx) {\n    onBeforeMount() {...},\n    onMounted() {...},\n    onBeforeUpdate() {...},\n    onUpdated() {...},\n    onBeforeUnmount() {...},\n    onUnmounted() {...},\n  }\n}")]),this._v("\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"globalApi"}},[n("a",{attrs:{href:"#globalApi"}},[this._v("#")]),this._v("\n            全局API\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[n("code",[this._v("import Vue from 'vue'\nimport App from './App.vue'\n\nVue.config.ignoredElements = [/^app-/]\nVue.use(/* ... */)\nVue.mixin(/* ... */)\nVue.component(/* ... */)\nVue.directive(/* ... */)\n\nnew Vue({\n  render: h => h(App)\n}).$mount('#app')\n")]),this._v("\n"),n("code",[this._v("import { createApp } from 'vue'\nimport App from './App.vue'\n\nconst app = createApp(App)\n\napp.config.ignoredElements = [/^app-/]\napp.use(/* ... */)\napp.mixin(/* ... */)\napp.component(/* ... */)\napp.directive(/* ... */)\n\napp.mount('#app')\n")]),this._v("\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"context"}},[n("a",{attrs:{href:"#context"}},[this._v("#")]),this._v("\n            实例属性之 attrs / slots / emit\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[n("code",[this._v("export default {\n  name: 'exapmle',\n  setup(props, ctx) {\n    console.log(ctx) // attrs / slots / emit\n  }\n  // props 不可以形参上解构，但 ctx 可以直接在形参上解构获取仍保持响应式\n  setup(props, {attrs, slots, emit}) {\n    console.log(attrs, slots, emit)\n  }\n}")]),this._v("\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"getCurrentInstance"}},[n("a",{attrs:{href:"#getCurrentInstance"}},[this._v("#")]),this._v("\n            getCurrentInstance 获取当前组件实例\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[this._v("            "),n("code",[this._v("import getCurrentInstance from 'getCurrentInstance';\nexport default {\n  name: 'example',\n  setup(\n    const vm = getCurrentInstance()\n    console.log('vm', vm) // root appContext parent, 包括 props data attrs slots emit refs render provides inject 等\n  )\n}\n            ")]),this._v("\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"refs"}},[n("a",{attrs:{href:"#refs"}},[this._v("#")]),this._v("\n            refs\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[this._v("            "),n("code",[this._v('<template>\n  <input ref="input" value="value"></input>\n</template>\n<script>\n  export default {\n    name: \'example\',\n    data() {\n      return {\n        value: 1\n      }\n    },\n    mounted() {\n      console.log(this.$refs.input)\n    }\n  }\n<\/script>')]),this._v("\n            "),n("code",[this._v("<template>\n  <input ref=\"input\" value=\"value\"></input>\n</template>\n<script>\n  import { ref onMounted} from 'vue';\n  export default {\n    name: 'example',\n    setup() {\n      const input = ref(null)\n      const value = ref(1)\n\n      onMounted(() => {\n        // input.value 返回的就是 input 元素 或者 组件实例\n        console.log(input.value)\n      })\n      return (\n        input,\n        value\n      )\n    }\n  }\n<\/script>")]),this._v("\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"nextTick"}},[n("a",{attrs:{href:"#nextTick"}},[this._v("#")]),this._v("\n            nextTick\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("pre",{staticClass:"language-js language-xml"},[this._v("            "),n("code",[this._v('<template>\n  <button @click="onShowInput" >显示input</button>\n  <input v-if="showInput" ref="el_input" value="value"></input>\n</template>\nexport default {\n  name: \'example\',\n  data() {\n    return {\n      showInput: false\n    }\n  }\n  method: {\n    onShowInput() {\n      this.showInput = true\n      this.$nextTick(() => {\n        console.log(this.$refs.el_input)\n      })\n    }\n  }\n}')]),this._v("\n            "),n("code",[this._v('<template>\n  <button @click="onShowInput" >显示input</button>\n  <input v-if="showInput" ref="el_input" value="value"></input>\n</template>\nimport { nextTick } from \'vue\';\nexport default {\n  name: \'example\',\n  setup() {\n    const el_input = ref(null)\n    const showInput = ref(false)\n    function onShowInput() {\n      showInput.value = true\n      nextTick(() => {\n        console.log(el_input.value)\n      })\n    }\n\n    return {\n      el_input,\n      showInput,\n      onShowInput\n    }\n  }\n}')]),this._v("\n          ")])},function(){var e=this.$createElement,n=this._self._c||e;return n("h2",{attrs:{id:"defineComponent"}},[n("a",{attrs:{href:"#defineComponent"}},[this._v("#")]),this._v("\n            defineComponent\n          ")])},function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("section",[t("h2",{attrs:{id:"abandon"}},[t("a",{attrs:{href:"#abandon"}},[e._v("#")]),e._v("\n            废弃属性\n          ")]),e._v(" "),t("p",[e._v("因为 Vue 2.x 中响应式原理使用 Object.defineProperty() ，所以存在以下问题：")]),e._v(" "),t("p",[e._v("1. 只对预置在 data 属性中的数据实现响应式, 在其它地方临时添加属性不具有响应式，此时需要调用 this.$set()添加属性才行，同样删除属性调用this.$delete删改属性同时删除响应式绑定")]),e._v(" "),t("p",[e._v("在 Vue3 中响应式原理使用 ES6 的 proxy 实现，即不存在上述问题，所以这些工具方法无用了。")]),e._v(" "),t("p",[e._v("包括全局属性 vue.set / delete ；实例属性 $set / $delete")]),e._v(" "),t("p",[e._v("另外 Vue.observale 功能也替换为 ref 和 reactive 方法来实现")])])}],!1,null,"3aa836c9",null);n.default=i.exports},99:function(e,n,t){}}]);